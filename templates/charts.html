<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Charts - Finsage</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px 0;
        }
        .chart-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .btn-back {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .btn-back:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            color: white;
        }
        .chart-image {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .no-data {
            text-align: center;
            padding: 3rem;
            color: #666;
            font-style: italic;
        }
        .month-selector {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 2rem;
        }
        .chart-section {
            margin-bottom: 3rem;
        }
        .chart-title {
            color: #333;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="chart-card">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>Financial Charts</h1>
                <a href="{% url 'dashboard' %}?month={{ selected_month }}" class="btn btn-back">Back to Dashboard</a>
            </div>

            <!-- Month Selector -->
            <div class="month-selector">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <label for="month-select" class="form-label"><strong>Select Month:</strong></label>
                        <select id="month-select" class="form-control" onchange="changeMonth()">
                            <option value="2024-06" {% if selected_month == "2024-06" %}selected{% endif %}>2024-06</option>
                            <option value="2024-07" {% if selected_month == "2024-07" %}selected{% endif %}>2024-07</option>
                            <option value="2024-08" {% if selected_month == "2024-08" %}selected{% endif %}>2024-08</option>
                            <option value="2024-09" {% if selected_month == "2024-09" %}selected{% endif %}>2024-09</option>
                            <option value="2024-10" {% if selected_month == "2024-10" %}selected{% endif %}>2024-10</option>
                            <option value="2024-11" {% if selected_month == "2024-11" %}selected{% endif %}>2024-11</option>
                            <option value="2024-12" {% if selected_month == "2024-12" %}selected{% endif %}>2024-12</option>
                            <option value="2025-01" {% if selected_month == "2025-01" %}selected{% endif %}>2025-01</option>
                            <option value="2025-02" {% if selected_month == "2025-02" %}selected{% endif %}>2025-02</option>
                            <option value="2025-03" {% if selected_month == "2025-03" %}selected{% endif %}>2025-03</option>
                            <option value="2025-04" {% if selected_month == "2025-04" %}selected{% endif %}>2025-04</option>
                            <option value="2025-05" {% if selected_month == "2025-05" %}selected{% endif %}>2025-05</option>
                            <option value="2025-06" {% if selected_month == "2025-06" %}selected{% endif %}>2025-06</option>
                            <option value="2025-07" {% if selected_month == "2025-07" %}selected{% endif %}>2025-07</option>
                            <option value="2025-08" {% if selected_month == "2025-08" %}selected{% endif %}>2025-08</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <p class="mb-0"><strong>Current Selection:</strong> {{ selected_month }}</p>
                        <small class="text-muted">
                            <strong>Month-specific charts:</strong> Pie charts and histograms show data for selected month.<br>
                            <strong>Trend charts:</strong> Line graph and heatmap show last 6 months.<br>
                            <strong>Category chart:</strong> Bar chart shows all-time data.
                        </small>
                    </div>
                </div>
            </div>

            <!-- Pie Charts Section -->
            <div class="chart-section">
                <h2 class="chart-title">Monthly Distribution Charts ({{ selected_month }})</h2>
                <div class="row">
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h3 class="text-center mb-4">Income Distribution</h3>
                            {% if income_chart %}
                            <img src="data:image/png;base64,{{ income_chart }}" alt="Income Distribution" class="chart-image">
                            {% else %}
                            <div class="no-data">
                                <h5>No income data available</h5>
                                <p>Add some income entries to see the distribution chart.</p>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="chart-card">
                            <h3 class="text-center mb-4">Expense Distribution</h3>
                            {% if expense_chart %}
                            <img src="data:image/png;base64,{{ expense_chart }}" alt="Expense Distribution" class="chart-image">
                            {% else %}
                            <div class="no-data">
                                <h5>No expense data available</h5>
                                <p>Add some expense entries to see the distribution chart.</p>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Histogram Section -->
            <div class="chart-section">
                <h2 class="chart-title">Amount Distribution Analysis ({{ selected_month }})</h2>
                <div class="chart-card">
                    <h3 class="text-center mb-4">Amount Distribution Histograms</h3>
                    {% if histogram_chart %}
                    <img src="data:image/png;base64,{{ histogram_chart }}" alt="Amount Distribution" class="chart-image">
                    {% else %}
                    <div class="no-data">
                        <h5>No distribution data available</h5>
                        <p>Add income and expense data to see amount distributions.</p>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Line Chart Section -->
            <div class="chart-section">
                <h2 class="chart-title">Monthly Trends (Last 6 Months)</h2>
                <div class="chart-card">
                    <h3 class="text-center mb-4">Income vs Expenses Trend</h3>
                    {% if line_chart %}
                    <img src="data:image/png;base64,{{ line_chart }}" alt="Monthly Trends" class="chart-image">
                    {% else %}
                    <div class="no-data">
                        <h5>No trend data available</h5>
                        <p>Add data for multiple months to see trends.</p>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Bar Chart Section -->
            <div class="chart-section">
                <h2 class="chart-title">Category Comparison (All Time)</h2>
                <div class="chart-card">
                    <h3 class="text-center mb-4">Income vs Expenses by Category</h3>
                    {% if bar_chart %}
                    <img src="data:image/png;base64,{{ bar_chart }}" alt="Category Comparison" class="chart-image">
                    {% else %}
                    <div class="no-data">
                        <h5>No category data available</h5>
                        <p>Add different categories of income and expenses to see comparisons.</p>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Heatmap Section -->
            <div class="chart-section">
                <h2 class="chart-title">Monthly Category Patterns (Last 6 Months)</h2>
                <div class="chart-card">
                    <h3 class="text-center mb-4">Monthly Category Heatmap</h3>
                    {% if heatmap_chart %}
                    <img src="data:image/png;base64,{{ heatmap_chart }}" alt="Monthly Patterns" class="chart-image">
                    {% else %}
                    <div class="no-data">
                        <h5>No heatmap data available</h5>
                        <p>Add data across multiple months and categories to see patterns.</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Month selector functionality
        function changeMonth() {
            const selectedMonth = document.getElementById('month-select').value;
            window.location.href = `{% url 'charts' %}?month=${selectedMonth}`;
        }
    </script>
</body>
</html> 